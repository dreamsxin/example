https://firefox-source-docs.mozilla.org/xpcom/stringguide.html

所有的字符串类都是从 `nsAString/nsACString` 这两个抽象基类派生。

| 宽                 | 窄                  |
|-------------------|--------------------|
| nsAString         | nsACString         |
| nsString          | nsCString          |
| nsAutoString      | nsAutoCString      |
| nsDependentString | nsDependentCString |

- nsAString/nsACString: 所有字符串类的基类，定义了xpcom中字符串的基本操作，如赋值、字符存取、基本的字符操作，比较等。nsAString 可以不必是以null（\0）结尾的。（nsAString is not necessarily null-terminated.）
- nsString/nsCString: 从以上两个基类继承而来，可以保证字符串是以null结尾。这两个类允许通过get()方法获取c风格的字符串（以'\0'结尾的字符数组）。

以为所有的字符串类都是从两个基类继承而来的，因为它们共享一些基本的API接口，如一些简单的只读函数：
.Length() - 字符串字符数目 (对于窄字符串类字符是char对于宽字节来说是PRUnichar)。
.IsEmpty() - 最快的可以判断字符串为空的方法. 用这个方法来代替 string.Length == 0
.Equals(string) - 判定两个字符串内容相同.

一些简单的改变字符串的方法：
.Assign(string) - 用string的值给字符串赋值.
.Append(string) - 追加string到字符串.
.Insert(string, position) - 在给定位置（position）的字符前插入string.
.Truncate(length) - 将字符串缩短到length指定的长度.

- char*
Raw character pointer to ASCII (7-bit) string, no string classes used.
- char16_t*
Raw character pointer to UTF-16 string, no string classes used.
- nsAString
UTF-16 string.
- nsACString
8-bit string
```c++
inline std::string ToString(const nsACString& text) {
  return {text.BeginReading(), text.Length()};
}

nsAutoString partitionKey;
partitionKey.AssignASCII(v.value().c_str());
NS_ConvertUTF16toUTF8(partitionKey);
```
- nsCString
```c++
nsCString(value.value().c_str())
```

- Append()

- AppendASCII()

- AppendLiteral()

- AppendPrintf()

- AppendFmt()

- AppendInt()

- AppendFloat()

- LossyAppendUTF16toASCII()

- AppendASCIItoUTF16()

- SetLength()

- Truncate()

- Assign()

- AssignLiteral()

- Adopt()

- CopyASCIItoUTF16()

- LossyCopyUTF16toASCII()

- AppendUTF16toUTF8()

- AppendUTF8toUTF16()

- CopyUTF16toUTF8()

- CopyUTF8toUTF16()


- NS_LossyConvertUTF16toASCII(nsAString) - a nsCAutoString which holds a temporary buffer containing the deflated value of the string.
- LossyCopyUTF16toASCII(nsAString, nsACString) - does an in-place conversion from UTF-16 into an ASCII string object.
- LossyAppendUTF16toASCII(nsAString, nsACString) - appends an UTF-16 string to an ASCII string, losing non-ASCII values.
- ToNewCString(nsAString) - allocates a new char* string.

- NS_ConvertASCIItoUTF16(nsACString) - a nsAutoString which holds a temporary buffer containing the inflated value of the string.
- CopyASCIItoUTF16(nsACString, nsAString) - does an in-place conversion from one string into a Unicode string object.
- AppendASCIItoUTF16(nsACString, nsAString) - appends an ASCII string to a Unicode string.
- ToNewUnicode(nsACString) - Creates a new PRUnichar* string which contains the inflated value.

- NS_LITERAL_CSTRING(literal string) - a temporary nsCString
- NS_NAMED_LITERAL_CSTRING(variable,literal string) - declares a nsCString variable named variable
- NS_LITERAL_STRING(literal string) - a temporary nsString with the unicode version of literal string
- NS_NAMED_LITERAL_STRING(variable,literal string) - declares a nsString variable named variable with the unicode version of literal string
```c++
// call Init(const PRUnichar*)
Init(L"start value"); // bad - L"..." is not portable!
Init(NS_ConvertASCIItoUTF16("start value").get()); // bad - runtime ASCII->UTF-16 conversion!
      
// call Init(const nsAString&)
Init(nsDependentString(L"start value")); // bad - not portable!
Init(NS_ConvertASCIItoUTF16("start value")); // bad - runtime ASCII->UTF-16 conversion!
      
// call Init(const nsACString&)
Init(nsDependentCString("start value")); // bad - length determined at runtime

// call Init(const PRUnichar*)
Init(NS_LITERAL_STRING("start value").get());

// call Init(const nsAString&)
Init(NS_LITERAL_STRING("start value"));

// call Init(const nsACString&)
Init(NS_LITERAL_CSTRING("start value"));

NS_NAMED_LITERAL_STRING(start, "start ");
NS_NAMED_LITERAL_STRING(middle, "middle ");
NS_NAMED_LITERAL_STRING(end, "end");
// create a string with 3 dependent fragments - no copying involved!
nsString combinedString = start + middle + end;

printf("%s\n", NS_LossyConvertUTF16toASCII(yourString).get());
printf("%s\n", NS_ConvertUTF16toUTF8(yourString).get());


```
