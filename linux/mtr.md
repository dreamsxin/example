# MTR 分析网络延迟及丢包

```shell
mtr -n -s 1024 -c 10 api.zookingsoft.com
mtr -n --report api.zookingsoft.com
```
MTR参数：

例如：mtr -n -i -a 0.0.0.0 1.1.1.1
- -n no-dns(或简写为-n) :不对IP地址做域名解析
- -s :用来指定ping数据包的大小
- -i :使用这个参数来设置ICMP返回之间的要求默认是1秒
- -a :来设置发送数据包的IP地址 这个对一个主机由多个IP地址是有用的
- -r :已报告模式显示
- -c : 每秒发送多少包，默认为10个。英文是(–report-cycles COUNT)
- –report ：结果显示，并不动态显示

由于网络状况的非对称性，建议收集双向的 MTR 数据下面三个经验总结：

1、丢包发生在目的服务器，则可能是目的服务器的网络配置不当引起；
2、丢包开始于前三跳，一般为本地运营商网络问题；
3、如果丢包发生在接近目的服务器的几跳，则可能为目的服务器运营商的网络问题。

## `mtr -T -P 192.168.0.1`

1. 基础功能
mtr（My Traceroute）是集成了traceroute和ping功能的网络诊断工具，可实时显示从本地到目标主机的网络路径质量，包括各节点的丢包率、延迟等统计信息。

2. 参数解析
-T：指定使用 TCP协议 进行探测（默认使用ICMP协议）。

用途：模拟TCP连接（如HTTP/HTTPS）场景，可检测目标端口是否开放及路径中TCP层面的网络问题。
-P 443：指定目标 端口号为443（-P为端口参数）。

用途：443是HTTPS协议默认端口，此参数用于测试到目标服务器HTTPS服务的网络路径。
192.168.0.1：目标服务器的IP地址，即网络诊断的终点。

3. 命令作用
该命令将通过 TCP协议 向 192.168.0.1:443 发送探测包，追踪从本地到目标服务器的完整网络路径，并输出各节点的丢包率、延迟（Last/Avg/Best/Wrst/StDev）等指标，适用于诊断HTTPS服务的网络连通性问题。
