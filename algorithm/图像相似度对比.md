# 常用的算法有几类

https://segmentfault.com/a/1190000038308093?u_atoken=171ec2ae58a232193f657ec3fe4ac2bf&u_asig=2760776517212092976758868e1a8e

## 一、Hash算法
Hash算法常用的有三种，分别为平均哈希算法(aHash)、感知哈希算法你(pHash)和差异哈哈希算法(dHash)；还有一种是小波哈希算法(whash)。
Hash算法都是通过获取图片的hash值，再比较两张图片hash值的汉明距离来度量两张图片是否相似。两张图片越相似，那么两张图片的hash数的汉明距离越小。

### 1、aHash-平均哈希
算法步骤
平均哈希算法是三种Hash算法中最简单的一种，它通过下面几个步骤来获得图片的Hash值：

(1) 缩放图片;
(2) 转灰度图; 
(3) 算像素均值;
(4) 根据相似均值计算指纹.

得到图片的ahash值后，比较两张图片ahash值的汉明距离，通常认为汉明距离小于10的一组图片为相似图片。

### 2、dHash-差异哈希
算法步骤
dhash和ahash算法的差别在于，ahash使用每个像素点与平均像素做对比得出布尔值，dhash是使用当前像素与后一个像素点做对比得到布尔值，正是这个原因，所以dhash算法需要将图片缩放为9*8个像素点。

（1）图片缩放为9*8，保留结构，出去细节； 
（2）灰度化：转换为256阶灰度图； 
（3）求平均值：计算灰度图所有像素的平均值；
（4）比较：像素值大于后一个像素值记作1，相反记作0。本行不与下一行对比，每行9个像素，八个差值，有8行，总共64位 ；
（5）生成hash：将上述步骤生成的1和0按顺序组合起来既是图片的指纹（hash）； 

### 3、pHash-感知哈希
算法步骤
dhash是三种Hash算法中较为复杂的一种，它是基于DCT（离散余弦变换）来得到图片的hash值：

（1）缩小图片：32*32是一个较好的大小，这样方便DCT计算；
（2）灰度化：转换为256阶灰度图； 
（3）计算DCT:DCT把图片分离成分率的集合，DCT（离散余弦变换）；
（4）缩小DCT：DCT计算后的矩阵是32 * 32，保留左上角的8 * 8，这些代表的图片的最低频率；
（5）计算平均值：计算缩小DCT后的所有像素点的平均值； 
（6）比较平均值：大于平均值记录为1，反之记录为0，得到phash值。

### 4、wHash-小波哈希
wavelet hash是频表示的另一种形式。whash相当于将phash中的DCT变换改为DWT。
离散小波变换（DWT）是频表示的另一种形式。流行的DCT和傅立叶变换使用余弦函数作为sin\cos的基础：sin(x)，sin(2x)，sin(3x)等等。与此相反，DWT使用一个单一的功能作为基础，但在不同的形式：缩放和移动。

小波hash在平时用的不多，在此不展开。

以上是所有hash算法的总结

### 5、彩蛋
那我们在平时使用过程中，是不需要自己手写hash算法过程的。为什么写在最后，其实是想让大家能够耐心看完前面的内容，对算法底层有一定的了解，求不挨打！
有现有的包(imagehash)供大家使用：
```shell
pip install imagehash
```
from imagehash import phash

def image_similar_compare(img1, img2):
    # 以phash为栗子，其余hash方法也可以直接引用的
    hash1 = phash(Image.open(img1))
    hash2 = phash(Image.open(img2))
    # 计算汉明距离
    return 1 - (hash1 - hash2) / len(hash1.hash) ** 2
```
## 二、SSIM算法
SSIM（结构相似性度量），这是一种全参考的图像质量评价指标，分别从亮度、对比度、结构三个方面度量图像相似性。 均值作为亮度的估计，标准差作为对比度的估计，协方差作为结构相似程度的度量。 SSIM取值范围[0,1]，值越大，表示图像失真越小，越相似。

计算步骤
在实际应用中，可以利用滑动窗将图像分块，令分块总数为N，考虑到窗口形状对分块的影响，采用高斯加权计算每一窗口的均值、方差以及协方差；然后计算对应块的结构相似度SSIM，最后将平均值作为两图像的结构相似性度量，即平均结构相似性MSSIM。

优点
结构相似度指数从图像组成的角度将结构信息定义为独立于亮度、对比度的反映场景中物体结构的属性，并将失真建模为亮度、对比度和结构三个不同因素的组合。

应用
SSIM已经成为广播和有线电视中广为使用的一种衡量视频质量的方法。在超分辨率，图像去模糊 中都有广泛的应用。
更多的是应用于同一张照片，在传输过程前后的对比。
